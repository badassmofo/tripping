#include "random.h"

/* Converts decimal to UTF8 string */
char* to_utf8 (unsigned long c) {
    unsigned long uc = 0x00000000 | (c & 0xFFFF);
    char* ret        = NULL;

    if (uc <= 0x7F) {
        ret    = malloc(2);
        ret[0] = uc                % 0x80;
        ret[1] = '\0';
    } else if (uc <= 0x7FF) {
        ret    = malloc(3);
        ret[0] = 0xC0 + (uc >>  6) % 0x20;
        ret[1] = 0x80 +  uc        % 0x40;
        ret[2] = '\0';
    } else if (uc <= 0xFFFF) {
        ret    = malloc(4);
        ret[0] = 0xE0 + (uc >> 12) % 0x10;
        ret[1] = 0x80 + (uc >>  6) % 0x40;
        ret[2] = 0x80 +  uc        % 0x40;
        ret[3] = '\0';
    } else if (uc <= 0x1FFFFF) {
        ret    = malloc(5);
        ret[0] = 0xF0 + (uc >> 18) % 0x8;
        ret[1] = 0x80 + (uc >> 12) % 0x40;
        ret[2] = 0x80 + (uc >>  6) % 0x40;
        ret[3] = 0x80 +  uc        % 0x40;
        ret[4] = '\0';
    } else if (uc <= 0x3FFFFFF) {
        ret    = malloc(6);
        ret[0] = 0xF8 + (uc >> 24) % 0x4;
        ret[1] = 0x80 + (uc >> 18) % 0x40;
        ret[2] = 0x80 + (uc >> 12) % 0x40;
        ret[3] = 0x80 + (uc >>  6) % 0x40;
        ret[4] = 0x80 +  uc        % 0x40;
        ret[5] = '\0';
    } else if (uc <= 0x7FFFFFFF) {
        ret    = malloc(7);
        ret[0] = 0xFC + (uc >> 30) % 0x2;
        ret[1] = 0x80 + (uc >> 24) % 0x40;
        ret[2] = 0x80 + (uc >> 18) % 0x40;
        ret[3] = 0x80 + (uc >> 12) % 0x40;
        ret[4] = 0x80 + (uc >>  6) % 0x40;
        ret[5] = 0x80 +  uc        % 0x40;
        ret[6] = '\0';
    }
    return ret;
}

/* Generates random ASCII string */
char* rndstr_ascii (unsigned short len) {
    char* ret = malloc(len);
    for (int i = 0; i < len; ++i)
        ret[i] = RAND_ASCII;
    ret[len] = '\0';
    return ret;
}

// Ranges arrays {{{
/* SJIS Character ranges */
static range_t ranges[] = {
    { 33,    126   }, { 167,   168   }, { 176,   177   },
    { 913,   929   }, { 931,   937   }, { 945,   961   },
    { 963,   969   }, { 1040,  1103  }, { 8216,  8217  },
    { 8220,  8221  }, { 8224,  8225  }, { 8229,  8230  },
    { 8242,  8243  }, { 8544,  8553  }, { 8560,  8569  },
    { 8592,  8595  }, { 8706,  8707  }, { 8711,  8712  },
    { 8733,  8736  }, { 8743,  8748  }, { 8756,  8757  },
    { 8800,  8801  }, { 8806,  8807  }, { 8810,  8811  },
    { 8834,  8835  }, { 8838,  8839  }, { 9312,  9331  },
    { 9472,  9475  }, { 9487,  9488  }, { 9491,  9492  },
    { 9495,  9496  }, { 9499,  9501  }, { 9507,  9509  },
    { 9515,  9516  }, { 9519,  9520  }, { 9523,  9524  },
    { 9527,  9528  }, { 9531,  9532  }, { 9632,  9633  },
    { 9650,  9651  }, { 9660,  9661  }, { 9670,  9671  },
    { 9678,  9679  }, { 9733,  9734  }, { 12288, 12291 },
    { 12293, 12309 }, { 12353, 12435 }, { 12443, 12446 },
    { 12449, 12534 }, { 12539, 12542 }, { 12849, 12850 },
    { 12964, 12968 }, { 13090, 13091 }, { 13094, 13095 },
    { 13129, 13130 }, { 13179, 13182 }, { 13198, 13199 },
    { 13212, 13214 }, { 19968, 19969 }, { 19975, 19979 },
    { 19981, 19982 }, { 19984, 19985 }, { 19988, 19993 },
    { 20017, 20018 }, { 20024, 20025 }, { 20027, 20028 },
    { 20034, 20035 }, { 20045, 20047 }, { 20053, 20057 },
    { 20061, 20063 }, { 20101, 20102 }, { 20104, 20108 },
    { 20113, 20114 }, { 20116, 20117 }, { 20120, 20121 },
    { 20123, 20124 }, { 20126, 20130 }, { 20132, 20134 },
    { 20139, 20142 }, { 20160, 20162 }, { 20166, 20167 },
    { 20170, 20171 }, { 20173, 20175 }, { 20180, 20185 },
    { 20189, 20191 }, { 20195, 20197 }, { 20205, 20206 },
    { 20214, 20215 }, { 20219, 20220 }, { 20224, 20225 },
    { 20233, 20234 }, { 20237, 20241 }, { 20252, 20253 },
    { 20271, 20272 }, { 20280, 20282 }, { 20284, 20285 },
    { 20294, 20295 }, { 20301, 20305 }, { 20309, 20311 },
    { 20313, 20318 }, { 20335, 20336 }, { 20341, 20342 },
    { 20347, 20348 }, { 20362, 20363 }, { 20369, 20370 },
    { 20378, 20379 }, { 20384, 20385 }, { 20397, 20399 },
    { 20405, 20406 }, { 20418, 20420 }, { 20425, 20426 },
    { 20429, 20430 }, { 20432, 20433 }, { 20439, 20440 },
    { 20442, 20443 }, { 20451, 20453 }, { 20462, 20463 },
    { 20469, 20470 }, { 20478, 20479 }, { 20485, 20486 },
    { 20497, 20498 }, { 20505, 20506 }, { 20510, 20511 },
    { 20513, 20518 }, { 20520, 20525 }, { 20546, 20547 },
    { 20550, 20553 }, { 20559, 20560 }, { 20565, 20566 },
    { 20596, 20598 }, { 20632, 20634 }, { 20652, 20653 },
    { 20658, 20661 }, { 20681, 20682 }, { 20693, 20694 },
    { 20717, 20718 }, { 20724, 20725 }, { 20736, 20738 },
    { 20756, 20758 }, { 20794, 20796 }, { 20799, 20801 },
    { 20803, 20814 }, { 20836, 20837 }, { 20840, 20846 },
    { 20853, 20856 }, { 20869, 20870 }, { 20873, 20874 },
    { 20876, 20877 }, { 20879, 20883 }, { 20885, 20887 },
    { 20900, 20902 }, { 20904, 20908 }, { 20912, 20919 },
    { 20925, 20926 }, { 20932, 20934 }, { 20939, 20941 },
    { 20955, 20958 }, { 20960, 20961 }, { 20966, 20967 },
    { 20969, 20970 }, { 20972, 20973 }, { 20976, 20977 },
    { 20981, 20982 }, { 20984, 20986 }, { 20989, 20990 },
    { 20995, 20996 }, { 20998, 21000 }, { 21002, 21003 },
    { 21012, 21013 }, { 21028, 21029 }, { 21033, 21034 },
    { 21046, 21051 }, { 21059, 21060 }, { 21066, 21069 },
    { 21091, 21093 }, { 21097, 21098 }, { 21103, 21109 },
    { 21127, 21129 }, { 21137, 21138 }, { 21147, 21148 },
    { 21151, 21152 }, { 21161, 21165 }, { 21172, 21173 },
    { 21184, 21185 }, { 21207, 21209 }, { 21213, 21216 },
    { 21218, 21220 }, { 21222, 21223 }, { 21234, 21235 },
    { 21240, 21242 }, { 21246, 21250 }, { 21253, 21256 },
    { 21263, 21264 }, { 21269, 21271 }, { 21273, 21274 },
    { 21280, 21281 }, { 21283, 21284 }, { 21304, 21307 },
    { 21311, 21313 }, { 21317, 21322 }, { 21329, 21332 },
    { 21335, 21336 }, { 21358, 21365 }, { 21367, 21368 },
    { 21407, 21408 }, { 21413, 21414 }, { 21416, 21417 },
    { 21421, 21422 }, { 21426, 21427 }, { 21442, 21443 },
    { 21448, 21454 }, { 21462, 21463 }, { 21473, 21477 },
    { 21480, 21491 }, { 21494, 21496 }, { 21507, 21508 },
    { 21512, 21521 }, { 21535, 21536 }, { 21547, 21550 },
    { 21560, 21561 }, { 21563, 21566 }, { 21576, 21578 },
    { 21616, 21617 }, { 21621, 21623 }, { 21627, 21629 },
    { 21642, 21644 }, { 21646, 21648 }, { 21668, 21669 },
    { 21672, 21673 }, { 21675, 21676 }, { 21682, 21683 },
    { 21692, 21694 }, { 21696, 21698 }, { 21703, 21705 },
    { 21729, 21730 }, { 21733, 21734 }, { 21736, 21737 },
    { 21741, 21742 }, { 21766, 21767 }, { 21775, 21776 },
    { 21806, 21807 }, { 21816, 21817 }, { 21828, 21830 },
    { 21846, 21847 }, { 21852, 21853 }, { 21883, 21884 },
    { 21891, 21892 }, { 21894, 21895 }, { 21897, 21899 },
    { 21912, 21914 }, { 21916, 21919 }, { 21927, 21932 },
    { 21956, 21957 }, { 21987, 21988 }, { 22013, 22014 },
    { 22038, 22040 }, { 22065, 22066 }, { 22122, 22124 },
    { 22150, 22151 }, { 22208, 22211 }, { 22231, 22232 },
    { 22234, 22235 }, { 22258, 22259 }, { 22265, 22266 },
    { 22271, 22272 }, { 22275, 22276 }, { 22280, 22281 },
    { 22290, 22291 }, { 22310, 22312 }, { 22327, 22328 },
    { 22350, 22353 }, { 22372, 22374 }, { 22377, 22378 },
    { 22408, 22409 }, { 22434, 22436 }, { 22470, 22472 },
    { 22482, 22484 }, { 22495, 22496 }, { 22521, 22522 },
    { 22533, 22534 }, { 22538, 22539 }, { 22575, 22577 },
    { 22580, 22581 }, { 22592, 22593 }, { 22602, 22603 },
    { 22609, 22610 }, { 22615, 22618 }, { 22686, 22687 },
    { 22706, 22707 }, { 22712, 22715 }, { 22743, 22745 },
    { 22750, 22751 }, { 22756, 22757 }, { 22763, 22764 },
    { 22766, 22770 }, { 22777, 22781 }, { 22793, 22795 },
    { 22799, 22800 }, { 22805, 22806 }, { 22808, 22812 },
    { 22825, 22830 }, { 22833, 22834 }, { 22839, 22840 },
    { 22855, 22857 }, { 22862, 22865 }, { 22867, 22869 },
    { 22871, 22872 }, { 22874, 22875 }, { 22882, 22883 },
    { 22887, 22890 }, { 22899, 22900 }, { 22913, 22916 },
    { 22947, 22949 }, { 22969, 22971 }, { 22992, 22993 },
    { 22995, 22996 }, { 23001, 23002 }, { 23013, 23014 },
    { 23018, 23019 }, { 23071, 23072 }, { 23093, 23094 },
    { 23104, 23105 }, { 23194, 23195 }, { 23228, 23230 },
    { 23233, 23234 }, { 23243, 23244 }, { 23254, 23255 },
    { 23290, 23291 }, { 23307, 23308 }, { 23376, 23377 },
    { 23380, 23384 }, { 23386, 23389 }, { 23395, 23398 },
    { 23408, 23409 }, { 23431, 23433 }, { 23435, 23437 },
    { 23447, 23453 }, { 23458, 23462 }, { 23475, 23478 },
    { 23480, 23481 }, { 23487, 23488 }, { 23490, 23495 },
    { 23506, 23508 }, { 23517, 23519 }, { 23521, 23522 },
    { 23524, 23529 }, { 23531, 23532 }, { 23541, 23542 },
    { 23550, 23551 }, { 23553, 23554 }, { 23556, 23563 },
    { 23565, 23567 }, { 23608, 23617 }, { 23621, 23622 },
    { 23626, 23627 }, { 23629, 23633 }, { 23648, 23649 },
    { 23652, 23653 }, { 23662, 23663 }, { 23696, 23697 },
    { 23720, 23721 }, { 23723, 23724 }, { 23734, 23736 },
    { 23738, 23740 }, { 23776, 23777 }, { 23784, 23786 },
    { 23791, 23792 }, { 23797, 23798 }, { 23802, 23803 },
    { 23828, 23835 }, { 23883, 23884 }, { 23890, 23891 },
    { 23916, 23917 }, { 23947, 23948 }, { 23991, 23994 },
    { 23996, 23997 }, { 24012, 24013 }, { 24018, 24019 },
    { 24029, 24030 }, { 24037, 24040 }, { 24049, 24053 },
    { 24061, 24062 }, { 24066, 24067 }, { 24075, 24076 },
    { 24089, 24091 }, { 24111, 24112 }, { 24118, 24120 },
    { 24131, 24133 }, { 24148, 24149 }, { 24161, 24164 },
    { 24178, 24182 }, { 24184, 24191 }, { 24195, 24196 },
    { 24213, 24215 }, { 24230, 24231 }, { 24245, 24248 },
    { 24257, 24259 }, { 24264, 24266 }, { 24271, 24272 },
    { 24282, 24283 }, { 24287, 24291 }, { 24296, 24297 },
    { 24304, 24305 }, { 24307, 24308 }, { 24310, 24312 },
    { 24314, 24316 }, { 24318, 24319 }, { 24323, 24324 },
    { 24329, 24333 }, { 24335, 24337 }, { 24339, 24344 },
    { 24357, 24359 }, { 24372, 24373 }, { 24375, 24376 },
    { 24406, 24407 }, { 24412, 24413 }, { 24417, 24418 },
    { 24422, 24423 }, { 24425, 24429 }, { 24432, 24433 },
    { 24447, 24453 }, { 24455, 24456 }, { 24458, 24460 },
    { 24464, 24467 }, { 24471, 24473 }, { 24480, 24481 },
    { 24488, 24490 }, { 24493, 24494 }, { 24499, 24500 },
    { 24508, 24509 }, { 24524, 24525 }, { 24534, 24537 },
    { 24540, 24542 }, { 24560, 24561 }, { 24590, 24592 },
    { 24597, 24598 }, { 24603, 24605 }, { 24608, 24609 },
    { 24613, 24619 }, { 24641, 24643 }, { 24650, 24651 },
    { 24665, 24666 }, { 24671, 24672 }, { 24674, 24677 },
    { 24680, 24685 }, { 24687, 24688 }, { 24707, 24709 },
    { 24713, 24717 }, { 24726, 24727 }, { 24730, 24731 },
    { 24735, 24736 }, { 24742, 24743 }, { 24745, 24746 },
    { 24754, 24758 }, { 24764, 24765 }, { 24773, 24775 },
    { 24798, 24801 }, { 24807, 24808 }, { 24816, 24820 },
    { 24822, 24823 }, { 24825, 24827 }, { 24832, 24833 },
    { 24840, 24841 }, { 24845, 24847 }, { 24858, 24859 },
    { 24863, 24865 }, { 24871, 24872 }, { 24892, 24895 },
    { 24903, 24904 }, { 24906, 24910 }, { 24920, 24922 },
    { 24930, 24931 }, { 24935, 24936 }, { 24942, 24945 },
    { 24947, 24951 }, { 24976, 24977 }, { 24984, 24986 },
    { 25003, 25004 }, { 25030, 25037 }, { 25078, 25080 },
    { 25084, 25088 }, { 25096, 25098 }, { 25100, 25102 },
    { 25104, 25108 }, { 25114, 25115 }, { 25117, 25119 },
    { 25134, 25136 }, { 25138, 25140 }, { 25151, 25153 },
    { 25159, 25161 }, { 25165, 25166 }, { 25214, 25216 },
    { 25218, 25220 }, { 25225, 25226 }, { 25233, 25240 },
    { 25243, 25244 }, { 25259, 25260 }, { 25275, 25277 },
    { 25285, 25290 }, { 25292, 25293 }, { 25295, 25300 },
    { 25303, 25305 }, { 25307, 25309 }, { 25312, 25313 },
    { 25324, 25327 }, { 25333, 25335 }, { 25342, 25343 },
    { 25345, 25346 }, { 25351, 25353 }, { 25383, 25384 },
    { 25405, 25407 }, { 25420, 25421 }, { 25423, 25424 },
    { 25447, 25449 }, { 25462, 25463 }, { 25466, 25467 },
    { 25480, 25481 }, { 25486, 25487 }, { 25503, 25507 },
    { 25511, 25516 }, { 25524, 25525 }, { 25539, 25540 },
    { 25551, 25552 }, { 25562, 25563 }, { 25588, 25590 },
    { 25622, 25623 }, { 25644, 25645 }, { 25746, 25747 },
    { 25757, 25758 }, { 25764, 25765 }, { 25773, 25774 },
    { 25787, 25788 }, { 25793, 25794 }, { 25805, 25806 },
    { 25824, 25827 }, { 25830, 25831 }, { 25841, 25842 },
    { 25853, 25854 }, { 25884, 25885 }, { 25891, 25892 },
    { 25898, 25900 }, { 25908, 25913 }, { 25918, 25919 },
    { 25933, 25935 }, { 25941, 25945 }, { 25949, 25950 },
    { 25954, 25955 }, { 25972, 25973 }, { 25975, 25976 },
    { 25986, 25987 }, { 25991, 25993 }, { 26000, 26001 },
    { 26011, 26012 }, { 26020, 26021 }, { 26027, 26029 },
    { 26031, 26032 }, { 26044, 26045 }, { 26051, 26054 },
    { 26059, 26060 }, { 26080, 26082 }, { 26085, 26089 },
    { 26092, 26093 }, { 26106, 26107 }, { 26114, 26115 },
    { 26118, 26119 }, { 26121, 26122 }, { 26126, 26127 },
    { 26131, 26133 }, { 26142, 26144 }, { 26148, 26149 },
    { 26151, 26152 }, { 26157, 26159 }, { 26164, 26166 },
    { 26171, 26172 }, { 26177, 26180 }, { 26205, 26207 },
    { 26212, 26217 }, { 26222, 26224 }, { 26227, 26228 },
    { 26243, 26244 }, { 26247, 26249 }, { 26262, 26265 },
    { 26296, 26297 }, { 26302, 26303 }, { 26329, 26330 },
    { 26332, 26333 }, { 26354, 26357 }, { 26359, 26368 },
    { 26376, 26377 }, { 26381, 26383 }, { 26388, 26391 },
    { 26397, 26399 }, { 26406, 26408 }, { 26410, 26414 },
    { 26422, 26424 }, { 26446, 26449 }, { 26462, 26470 },
    { 26479, 26483 }, { 26494, 26495 }, { 26507, 26508 },
    { 26524, 26525 }, { 26528, 26530 }, { 26547, 26548 },
    { 26550, 26553 }, { 26560, 26561 }, { 26574, 26577 },
    { 26579, 26580 }, { 26589, 26590 }, { 26606, 26607 },
    { 26611, 26613 }, { 26622, 26623 }, { 26625, 26628 },
    { 26646, 26647 }, { 26657, 26658 }, { 26665, 26667 },
    { 26680, 26681 }, { 26684, 26685 }, { 26688, 26692 },
    { 26701, 26702 }, { 26704, 26708 }, { 26716, 26717 },
    { 26742, 26743 }, { 26750, 26751 }, { 26771, 26772 },
    { 26783, 26784 }, { 26790, 26792 }, { 26799, 26801 },
    { 26805, 26806 }, { 26809, 26810 }, { 26824, 26827 },
    { 26836, 26837 }, { 26839, 26840 }, { 26847, 26849 },
    { 26862, 26863 }, { 26873, 26874 }, { 26880, 26881 },
    { 26884, 26885 }, { 26891, 26895 }, { 26905, 26908 },
    { 26913, 26915 }, { 26917, 26918 }, { 26963, 26965 },
    { 26969, 26970 }, { 26972, 26974 }, { 26976, 26978 },
    { 26986, 26987 }, { 26989, 26991 }, { 26995, 26997 },
    { 26999, 27001 }, { 27004, 27006 }, { 27009, 27010 },
    { 27028, 27029 }, { 27035, 27036 }, { 27057, 27058 },
    { 27070, 27071 }, { 27082, 27086 }, { 27096, 27097 },
    { 27101, 27102 }, { 27111, 27112 }, { 27146, 27148 },
    { 27154, 27156 }, { 27166, 27167 }, { 27169, 27171 },
    { 27177, 27179 }, { 27189, 27190 }, { 27192, 27194 },
    { 27206, 27208 }, { 27224, 27225 }, { 27233, 27234 },
    { 27250, 27251 }, { 27262, 27264 }, { 27277, 27278 },
    { 27298, 27299 }, { 27329, 27331 }, { 27354, 27355 },
    { 27358, 27359 }, { 27386, 27387 }, { 27396, 27397 },
    { 27423, 27425 }, { 27447, 27450 }, { 27453, 27454 },
    { 27475, 27476 }, { 27489, 27492 }, { 27497, 27498 },
    { 27507, 27508 }, { 27512, 27513 }, { 27519, 27520 },
    { 27523, 27524 }, { 27529, 27531 }, { 27541, 27542 },
    { 27562, 27563 }, { 27569, 27573 }, { 27578, 27580 },
    { 27583, 27584 }, { 27589, 27590 }, { 27597, 27598 },
    { 27602, 27604 }, { 27627, 27628 }, { 27667, 27668 },
    { 27683, 27684 }, { 27703, 27704 }, { 27710, 27714 },
    { 27740, 27744 }, { 27759, 27760 }, { 27762, 27763 },
    { 27773, 27774 }, { 27777, 27779 }, { 27788, 27789 },
    { 27794, 27795 }, { 27801, 27803 }, { 27809, 27810 },
    { 27832, 27839 }, { 27844, 27845 }, { 27849, 27850 },
    { 27865, 27867 }, { 27873, 27875 }, { 27887, 27889 },
    { 27915, 27916 }, { 27934, 27935 }, { 27945, 27947 },
    { 27954, 27955 }, { 27957, 27958 }, { 27965, 27966 },
    { 27972, 27973 }, { 27993, 27994 }, { 28003, 28004 },
    { 28009, 28010 }, { 28014, 28015 }, { 28023, 28025 },
    { 28039, 28040 }, { 28053, 28054 }, { 28059, 28060 },
    { 28101, 28103 }, { 28107, 28108 }, { 28113, 28114 },
    { 28120, 28121 }, { 28138, 28140 }, { 28145, 28147 },
    { 28151, 28156 }, { 28167, 28171 }, { 28185, 28187 },
    { 28191, 28193 }, { 28195, 28199 }, { 28203, 28207 },
    { 28216, 28218 }, { 28237, 28238 }, { 28251, 28252 },
    { 28270, 28271 }, { 28286, 28288 }, { 28303, 28304 },
    { 28316, 28317 }, { 28342, 28343 }, { 28356, 28357 },
    { 28363, 28364 }, { 28371, 28373 }, { 28381, 28382 },
    { 28407, 28408 }, { 28414, 28415 }, { 28417, 28418 },
    { 28435, 28437 }, { 28450, 28451 }, { 28459, 28460 },
    { 28465, 28466 }, { 28478, 28479 }, { 28507, 28508 },
    { 28525, 28528 }, { 28544, 28546 }, { 28579, 28580 },
    { 28608, 28611 }, { 28628, 28629 }, { 28639, 28641 },
    { 28651, 28652 }, { 28654, 28655 }, { 28661, 28662 },
    { 28698, 28699 }, { 28701, 28703 }, { 28710, 28712 },
    { 28783, 28784 }, { 28796, 28797 }, { 28809, 28810 },
    { 28843, 28847 }, { 28856, 28859 }, { 28953, 28954 },
    { 28998, 28999 }, { 29013, 29014 }, { 29028, 29031 },
    { 29076, 29077 }, { 29128, 29129 }, { 29140, 29141 },
    { 29151, 29152 }, { 29157, 29159 }, { 29164, 29166 },
    { 29179, 29180 }, { 29182, 29183 }, { 29228, 29229 },
    { 29237, 29238 }, { 29242, 29248 }, { 29254, 29256 },
    { 29259, 29260 }, { 29272, 29273 }, { 29281, 29282 },
    { 29309, 29310 }, { 29312, 29314 }, { 29361, 29362 },
    { 29378, 29380 }, { 29408, 29410 }, { 29420, 29421 },
    { 29431, 29433 }, { 29436, 29437 }, { 29462, 29463 },
    { 29467, 29469 }, { 29476, 29477 }, { 29481, 29483 },
    { 29486, 29487 }, { 29494, 29495 }, { 29502, 29503 },
    { 29508, 29509 }, { 29518, 29519 }, { 29559, 29560 },
    { 29562, 29563 }, { 29618, 29619 }, { 29640, 29642 },
    { 29645, 29646 }, { 29677, 29678 }, { 29701, 29703 },
    { 29733, 29734 }, { 29737, 29738 }, { 29746, 29750 },
    { 29785, 29788 }, { 29790, 29792 }, { 29794, 29796 },
    { 29801, 29802 }, { 29807, 29808 }, { 29854, 29855 },
    { 29922, 29923 }, { 29926, 29927 }, { 29936, 29938 },
    { 29942, 29944 }, { 29955, 29957 }, { 29964, 29966 },
    { 29982, 29983 }, { 29989, 29990 }, { 29995, 29996 },
    { 29999, 30003 }, { 30007, 30008 }, { 30010, 30012 },
    { 30025, 30029 }, { 30041, 30045 }, { 30052, 30055 },
    { 30057, 30059 }, { 30063, 30064 }, { 30067, 30068 },
    { 30070, 30072 }, { 30086, 30087 }, { 30089, 30091 },
    { 30094, 30095 }, { 30129, 30131 }, { 30136, 30137 },
    { 30140, 30142 }, { 30146, 30147 }, { 30164, 30165 },
    { 30168, 30169 }, { 30178, 30179 }, { 30194, 30196 },
    { 30206, 30207 }, { 30239, 30242 }, { 30278, 30280 },
    { 30305, 30306 }, { 30311, 30314 }, { 30330, 30334 },
    { 30338, 30340 }, { 30342, 30344 }, { 30361, 30364 },
    { 30391, 30394 }, { 30402, 30403 }, { 30422, 30423 },
    { 30427, 30428 }, { 30430, 30431 }, { 30435, 30437 },
    { 30471, 30473 }, { 30475, 30476 }, { 30494, 30496 },
    { 30500, 30502 }, { 30519, 30520 }, { 30534, 30535 },
    { 30554, 30555 }, { 30565, 30566 }, { 30590, 30591 },
    { 30636, 30637 }, { 30651, 30653 }, { 30682, 30684 },
    { 30690, 30691 }, { 30701, 30703 }, { 30740, 30741 },
    { 30752, 30753 }, { 30757, 30759 }, { 30827, 30828 },
    { 30854, 30855 }, { 30860, 30862 }, { 30889, 30890 },
    { 30917, 30918 }, { 30922, 30923 }, { 30928, 30929 },
    { 30951, 30952 }, { 30993, 30994 }, { 31018, 31020 },
    { 31040, 31041 }, { 31047, 31049 }, { 31061, 31063 },
    { 31069, 31072 }, { 31103, 31105 }, { 31108, 31109 },
    { 31117, 31119 }, { 31142, 31143 }, { 31161, 31162 },
    { 31165, 31169 }, { 31185, 31186 }, { 31203, 31204 },
    { 31206, 31207 }, { 31245, 31246 }, { 31255, 31258 },
    { 31263, 31264 }, { 31281, 31282 }, { 31291, 31296 },
    { 31298, 31299 }, { 31309, 31312 }, { 31329, 31331 },
    { 31353, 31354 }, { 31363, 31364 }, { 31378, 31379 },
    { 31381, 31384 }, { 31401, 31402 }, { 31406, 31408 },
    { 31427, 31429 }, { 31431, 31432 }, { 31434, 31435 },
    { 31441, 31443 }, { 31449, 31450 }, { 31452, 31453 },
    { 31455, 31459 }, { 31461, 31463 }, { 31466, 31467 },
    { 31471, 31472 }, { 31480, 31482 }, { 31498, 31499 },
    { 31512, 31513 }, { 31525, 31526 }, { 31541, 31542 },
    { 31557, 31558 }, { 31560, 31561 }, { 31563, 31565 },
    { 31567, 31570 }, { 31600, 31601 }, { 31604, 31605 },
    { 31622, 31623 }, { 31636, 31637 }, { 31639, 31642 },
    { 31644, 31647 }, { 31680, 31681 }, { 31686, 31687 },
    { 31691, 31692 }, { 31716, 31718 }, { 31734, 31735 },
    { 31761, 31764 }, { 31786, 31787 }, { 31799, 31800 },
    { 31805, 31808 }, { 31820, 31821 }, { 31823, 31824 },
    { 31839, 31840 }, { 31844, 31845 }, { 31873, 31875 },
    { 31895, 31896 }, { 31905, 31906 }, { 31908, 31909 },
    { 31911, 31912 }, { 31917, 31918 }, { 31921, 31923 },
    { 31933, 31934 }, { 31966, 31968 }, { 31994, 31995 },
    { 32004, 32006 }, { 32010, 32011 }, { 32020, 32021 },
    { 32023, 32028 }, { 32032, 32034 }, { 32043, 32044 },
    { 32046, 32048 }, { 32050, 32051 }, { 32057, 32058 },
    { 32066, 32070 }, { 32075, 32076 }, { 32078, 32080 },
    { 32091, 32092 }, { 32097, 32099 }, { 32113, 32115 },
    { 32117, 32118 }, { 32153, 32156 }, { 32159, 32160 },
    { 32162, 32163 }, { 32171, 32178 }, { 32180, 32181 },
    { 32183, 32184 }, { 32186, 32187 }, { 32189, 32191 },
    { 32202, 32203 }, { 32209, 32210 }, { 32213, 32214 },
    { 32220, 32222 }, { 32224, 32225 }, { 32232, 32233 },
    { 32260, 32261 }, { 32265, 32267 }, { 32286, 32287 },
    { 32289, 32291 }, { 32305, 32306 }, { 32313, 32315 },
    { 32317, 32318 }, { 32330, 32331 }, { 32340, 32342 },
    { 32345, 32346 }, { 32349, 32350 }, { 32358, 32359 },
    { 32361, 32362 }, { 32379, 32381 }, { 32386, 32387 },
    { 32392, 32394 }, { 32398, 32400 }, { 32402, 32404 },
    { 32411, 32412 }, { 32588, 32590 }, { 32592, 32593 },
    { 32596, 32597 }, { 32607, 32608 }, { 32615, 32619 },
    { 32631, 32633 }, { 32642, 32643 }, { 32645, 32648 },
    { 32669, 32670 }, { 32675, 32676 }, { 32680, 32681 },
    { 32686, 32687 }, { 32696, 32697 }, { 32709, 32710 },
    { 32724, 32725 }, { 32736, 32737 }, { 32763, 32764 },
    { 32768, 32769 }, { 32771, 32774 }, { 32779, 32780 },
    { 32791, 32793 }, { 32862, 32863 }, { 32865, 32866 },
    { 32879, 32880 }, { 32882, 32884 }, { 32886, 32887 },
    { 32893, 32895 }, { 32900, 32903 }, { 32907, 32908 },
    { 32922, 32923 }, { 32929, 32930 }, { 32937, 32938 },
    { 32940, 32941 }, { 32945, 32946 }, { 32963, 32964 },
    { 32985, 32987 }, { 32989, 32990 }, { 32996, 32997 },
    { 33020, 33021 }, { 33029, 33034 }, { 33050, 33051 },
    { 33104, 33105 }, { 33107, 33109 }, { 33125, 33126 },
    { 33136, 33137 }, { 33144, 33146 }, { 33151, 33152 },
    { 33154, 33155 }, { 33180, 33181 }, { 33187, 33188 },
    { 33192, 33193 }, { 33213, 33216 }, { 33224, 33225 },
    { 33240, 33242 }, { 33247, 33248 }, { 33255, 33256 },
    { 33267, 33268 }, { 33274, 33276 }, { 33281, 33282 },
    { 33287, 33290 }, { 33292, 33294 }, { 33302, 33304 },
    { 33307, 33308 }, { 33310, 33311 }, { 33321, 33324 },
    { 33333, 33337 }, { 33368, 33370 }, { 33386, 33387 },
    { 33390, 33391 }, { 33393, 33394 }, { 33398, 33400 },
    { 33445, 33446 }, { 33451, 33453 }, { 33464, 33465 },
    { 33489, 33492 }, { 33499, 33500 }, { 33502, 33503 },
    { 33509, 33511 }, { 33523, 33524 }, { 33529, 33531 },
    { 33537, 33542 }, { 33558, 33560 }, { 33585, 33586 },
    { 33588, 33590 }, { 33592, 33593 }, { 33609, 33610 },
    { 33615, 33616 }, { 33659, 33660 }, { 33673, 33674 },
    { 33694, 33696 }, { 33706, 33707 }, { 33759, 33760 },
    { 33775, 33778 }, { 33782, 33783 }, { 33795, 33796 },
    { 33803, 33806 }, { 33833, 33834 }, { 33852, 33853 },
    { 33864, 33865 }, { 33889, 33891 }, { 33899, 33903 },
    { 33913, 33914 }, { 33976, 33977 }, { 33979, 33980 },
    { 33993, 33995 }, { 34000, 34001 }, { 34009, 34010 },
    { 34047, 34048 }, { 34067, 34069 }, { 34071, 34072 },
    { 34092, 34093 }, { 34112, 34113 }, { 34120, 34123 },
    { 34135, 34138 }, { 34152, 34155 }, { 34183, 34184 },
    { 34192, 34193 }, { 34203, 34204 }, { 34216, 34220 },
    { 34222, 34224 }, { 34233, 34234 }, { 34255, 34256 },
    { 34268, 34269 }, { 34276, 34277 }, { 34281, 34282 },
    { 34297, 34299 }, { 34310, 34311 }, { 34314, 34315 },
    { 34322, 34323 }, { 34326, 34327 }, { 34351, 34352 },
    { 34381, 34382 }, { 34388, 34389 }, { 34398, 34399 },
    { 34442, 34444 }, { 34467, 34468 }, { 34473, 34475 },
    { 34479, 34480 }, { 34502, 34503 }, { 34509, 34510 },
    { 34526, 34527 }, { 34540, 34543 }, { 34552, 34553 },
    { 34562, 34563 }, { 34568, 34570 }, { 34577, 34578 },
    { 34635, 34636 }, { 34655, 34656 }, { 34746, 34747 },
    { 34758, 34759 }, { 34806, 34807 }, { 34829, 34831 },
    { 34837, 34838 }, { 34849, 34851 }, { 34892, 34893 },
    { 34898, 34899 }, { 34909, 34910 }, { 34913, 34915 },
    { 34941, 34943 }, { 34945, 34946 }, { 34966, 34967 },
    { 34992, 34993 }, { 34996, 34997 }, { 35009, 35013 },
    { 35028, 35029 }, { 35032, 35033 }, { 35036, 35037 },
    { 35058, 35061 }, { 35064, 35065 }, { 35068, 35070 },
    { 35090, 35091 }, { 35100, 35102 }, { 35114, 35115 },
    { 35139, 35140 }, { 35148, 35149 }, { 35166, 35168 },
    { 35198, 35199 }, { 35206, 35208 }, { 35210, 35211 },
    { 35222, 35224 }, { 35238, 35239 }, { 35241, 35242 },
    { 35250, 35251 }, { 35263, 35264 }, { 35292, 35293 },
    { 35302, 35303 }, { 35330, 35331 }, { 35346, 35347 },
    { 35350, 35352 }, { 35379, 35380 }, { 35382, 35383 },
    { 35386, 35388 }, { 35408, 35410 }, { 35412, 35413 },
    { 35426, 35427 }, { 35435, 35438 }, { 35440, 35443 },
    { 35460, 35461 }, { 35468, 35469 }, { 35488, 35489 },
    { 35491, 35496 }, { 35500, 35501 }, { 35518, 35519 },
    { 35531, 35533 }, { 35546, 35548 }, { 35550, 35554 },
    { 35558, 35559 }, { 35565, 35566 }, { 35574, 35576 },
    { 35584, 35586 }, { 35606, 35607 }, { 35609, 35611 },
    { 35616, 35617 }, { 35627, 35628 }, { 35662, 35663 },
    { 35674, 35676 }, { 35691, 35692 }, { 35695, 35698 },
    { 35711, 35712 }, { 35730, 35731 }, { 35737, 35738 },
    { 35937, 35938 }, { 35946, 35948 }, { 35960, 35962 },
    { 35977, 35978 }, { 35980, 35982 }, { 35997, 35998 },
    { 36000, 36002 }, { 36007, 36016 }, { 36018, 36020 },
    { 36022, 36024 }, { 36027, 36029 }, { 36031, 36036 },
    { 36039, 36040 }, { 36045, 36046 }, { 36058, 36060 },
    { 36066, 36068 }, { 36090, 36093 }, { 36100, 36101 },
    { 36103, 36104 }, { 36106, 36107 }, { 36111, 36112 },
    { 36114, 36116 }, { 36198, 36199 }, { 36208, 36209 },
    { 36211, 36212 }, { 36214, 36215 }, { 36299, 36300 },
    { 36314, 36315 }, { 36330, 36331 }, { 36360, 36362 },
    { 36367, 36368 }, { 36381, 36383 }, { 36404, 36405 },
    { 36423, 36426 }, { 36447, 36448 }, { 36451, 36452 },
    { 36484, 36485 }, { 36490, 36491 }, { 36499, 36500 },
    { 36522, 36524 }, { 36527, 36529 }, { 36549, 36550 },
    { 36554, 36557 }, { 36578, 36579 }, { 36603, 36606 },
    { 36617, 36618 }, { 36626, 36629 }, { 36635, 36637 },
    { 36649, 36650 }, { 36664, 36665 }, { 36670, 36671 },
    { 36676, 36678 }, { 36684, 36686 }, { 36705, 36708 },
    { 36763, 36764 }, { 36766, 36767 }, { 36775, 36776 },
    { 36781, 36786 }, { 36794, 36796 }, { 36804, 36805 },
    { 36837, 36838 }, { 36841, 36843 }, { 36847, 36848 },
    { 36855, 36858 }, { 36864, 36865 }, { 36869, 36870 },
    { 36877, 36881 }, { 36883, 36887 }, { 36889, 36890 },
    { 36893, 36899 }, { 36913, 36914 }, { 36917, 36918 },
    { 36920, 36921 }, { 36929, 36930 }, { 36937, 36939 },
    { 36941, 36950 }, { 36952, 36953 }, { 36960, 36961 },
    { 36967, 36969 }, { 36973, 36975 }, { 36981, 36984 },
    { 36988, 36989 }, { 36991, 36996 }, { 37001, 37002 },
    { 37089, 37090 }, { 37193, 37198 }, { 37218, 37219 },
    { 37225, 37226 }, { 37234, 37235 }, { 37239, 37240 },
    { 37290, 37291 }, { 37300, 37301 }, { 37312, 37313 },
    { 37318, 37321 }, { 37323, 37329 }, { 37334, 37336 },
    { 37338, 37343 }, { 37347, 37351 }, { 37357, 37358 },
    { 37365, 37366 }, { 37389, 37390 }, { 37392, 37393 },
    { 37396, 37397 }, { 37433, 37434 }, { 37439, 37440 },
    { 37444, 37445 }, { 37448, 37449 }, { 37456, 37457 },
    { 37465, 37467 }, { 37478, 37479 }, { 37495, 37496 },
    { 37525, 37526 }, { 37530, 37532 }, { 37583, 37584 },
    { 37586, 37587 }, { 37609, 37610 }, { 37618, 37619 },
    { 37624, 37628 }, { 37647, 37648 }, { 37656, 37658 },
    { 37661, 37662 }, { 37664, 37667 }, { 37669, 37670 },
    { 37675, 37676 }, { 37678, 37679 }, { 37690, 37691 },
    { 37718, 37719 }, { 37723, 37724 }, { 37782, 37783 },
    { 37804, 37806 }, { 37840, 37841 }, { 37846, 37848 },
    { 37853, 37854 }, { 37860, 37861 }, { 37907, 37908 },
    { 37912, 37914 }, { 37941, 37942 }, { 37956, 37957 },
    { 37969, 37971 }, { 37978, 37979 }, { 38012, 38015 },
    { 38274, 38275 }, { 38281, 38283 }, { 38289, 38292 },
    { 38296, 38297 }, { 38306, 38309 }, { 38311, 38312 },
    { 38331, 38332 }, { 38348, 38349 }, { 38356, 38358 },
    { 38369, 38370 }, { 38446, 38447 }, { 38463, 38464 },
    { 38475, 38477 }, { 38479, 38480 }, { 38491, 38495 },
    { 38498, 38502 }, { 38514, 38515 }, { 38517, 38520 },
    { 38533, 38534 }, { 38538, 38539 }, { 38541, 38543 },
    { 38548, 38549 }, { 38551, 38553 }, { 38555, 38557 },
    { 38567, 38568 }, { 38575, 38578 }, { 38582, 38585 },
    { 38587, 38588 }, { 38592, 38593 }, { 38596, 38599 },
    { 38603, 38606 }, { 38613, 38614 }, { 38619, 38620 },
    { 38626, 38627 }, { 38634, 38635 }, { 38646, 38647 },
    { 38662, 38664 }, { 38669, 38671 }, { 38706, 38707 },
    { 38712, 38713 }, { 38717, 38718 }, { 38722, 38724 },
    { 38728, 38729 }, { 38737, 38738 }, { 38741, 38742 },
    { 38752, 38754 }, { 38760, 38761 }, { 38777, 38778 },
    { 38788, 38790 }, { 38799, 38800 }, { 38835, 38836 },
    { 38893, 38894 }, { 38898, 38899 }, { 38901, 38902 },
    { 38913, 38915 }, { 38917, 38918 }, { 38927, 38931 },
    { 38935, 38936 }, { 38956, 38957 }, { 38967, 38968 },
    { 38971, 38973 }, { 38987, 38991 }, { 38996, 38997 },
    { 38999, 39000 }, { 39023, 39025 }, { 39027, 39028 },
    { 39107, 39108 }, { 39131, 39132 }, { 39149, 39151 },
    { 39164, 39166 }, { 39177, 39178 }, { 39186, 39188 },
    { 39197, 39198 }, { 39200, 39201 }, { 39207, 39208 },
    { 39229, 39230 }, { 39243, 39244 }, { 39248, 39250 },
    { 39318, 39321 }, { 39340, 39342 }, { 39347, 39348 },
    { 39364, 39366 }, { 39376, 39378 }, { 39405, 39406 },
    { 39409, 39410 }, { 39438, 39439 }, { 39442, 39443 },
    { 39490, 39491 }, { 39501, 39502 }, { 39514, 39515 },
    { 39524, 39525 }, { 39529, 39531 }, { 39635, 39636 },
    { 39640, 39641 }, { 39646, 39647 }, { 39650, 39651 },
    { 39658, 39659 }, { 39661, 39663 }, { 39714, 39715 },
    { 39719, 39722 }, { 39726, 39727 }, { 39729, 39730 },
    { 39739, 39740 }, { 39745, 39749 }, { 39757, 39759 },
    { 39796, 39797 }, { 39822, 39823 }, { 39825, 39827 },
    { 39830, 39831 }, { 39839, 39840 }, { 39850, 39851 },
    { 39853, 39854 }, { 39881, 39882 }, { 39889, 39890 },
    { 39905, 39908 }, { 39920, 39922 }, { 39944, 39946 },
    { 39948, 39949 }, { 39954, 39957 }, { 39972, 39973 },
    { 39981, 39984 }, { 39993, 39995 }, { 40006, 40008 },
    { 40171, 40172 }, { 40179, 40180 }, { 40198, 40201 },
    { 40234, 40236 }, { 40254, 40255 }, { 40272, 40273 },
    { 40284, 40286 }, { 40288, 40289 }, { 40299, 40300 },
    { 40303, 40304 }, { 40378, 40379 }, { 40385, 40386 },
    { 40440, 40442 }, { 40473, 40475 }, { 40568, 40569 },
    { 40587, 40588 }, { 40593, 40595 }, { 40613, 40614 },
    { 40617, 40618 }, { 40632, 40636 }, { 40638, 40639 },
    { 40652, 40658 }, { 40664, 40665 }, { 40667, 40670 },
    { 40694, 40695 }, { 40699, 40701 }, { 40711, 40712 },
    { 40736, 40737 }, { 40778, 40779 }, { 40782, 40783 },
    { 40799, 40803 }, { 40806, 40807 }, { 40822, 40823 },
    { 40860, 40861 }, { 57344, 59223 }, { 64014, 64015 },
    { 64019, 64020 }, { 64035, 64036 }, { 64039, 64041 },
    { 65281, 65374 }, { 65504, 65508 } };
#define TOTAL_RANGES 1556
// }}}

// Left-over array {{{
/* SJIS characters not in ranges */
static unsigned short left_overs[] = {
    180,   182,   197,   215,   247,   1025,  1105,  8208,  8213,
    8240,  8251,  8451,  8470,  8481,  8658,  8660,  8704,  8715,
    8721,  8730,  8741,  8750,  8765,  8786,  8869,  8895,  8978,
    9484,  9504,  9512,  9535,  9538,  9547,  9675,  9711,  9792,
    9794,  9834,  9837,  9839,  12317, 12319, 12857, 13059, 13069,
    13076, 13080, 13099, 13110, 13115, 13133, 13137, 13143, 13217,
    13252, 13261, 19971, 19998, 20001, 20006, 20008, 20010, 20013,
    20022, 20031, 20037, 20043, 20066, 20081, 20083, 20094, 20096,
    20098, 20110, 20136, 20144, 20147, 20150, 20154, 20164, 20193,
    20208, 20210, 20227, 20250, 20276, 20278, 20291, 20307, 20329,
    20339, 20351, 20355, 20358, 20360, 20365, 20367, 20372, 20374,
    20376, 20381, 20395, 20415, 20436, 20445, 20447, 20449, 20467,
    20472, 20474, 20489, 20491, 20493, 20495, 20500, 20502, 20534,
    20537, 20544, 20570, 20572, 20581, 20588, 20592, 20594, 20600,
    20605, 20608, 20613, 20621, 20625, 20628, 20663, 20670, 20674,
    20677, 20685, 20687, 20689, 20696, 20698, 20702, 20707, 20709,
    20711, 20729, 20731, 20740, 20745, 20754, 20760, 20762, 20767,
    20769, 20778, 20786, 20791, 20816, 20818, 20820, 20826, 20828,
    20834, 20849, 20860, 20864, 20866, 20889, 20893, 20896, 20898,
    20937, 20950, 20992, 21006, 21009, 21015, 21021, 21031, 21038,
    21040, 21043, 21063, 21071, 21076, 21078, 21083, 21086, 21117,
    21119, 21123, 21133, 21140, 21155, 21158, 21167, 21169, 21177,
    21180, 21182, 21187, 21189, 21191, 21193, 21197, 21202, 21205,
    21211, 21237, 21261, 21277, 21290, 21295, 21297, 21299, 21315,
    21325, 21338, 21340, 21342, 21344, 21350, 21353, 21371, 21375,
    21378, 21380, 21395, 21398, 21400, 21402, 21424, 21430, 21435,
    21460, 21465, 21467, 21469, 21471, 21498, 21505, 21531, 21533,
    21542, 21545, 21558, 21568, 21570, 21574, 21582, 21585, 21599,
    21608, 21610, 21619, 21632, 21636, 21638, 21650, 21660, 21666,
    21679, 21688, 21700, 21720, 21746, 21754, 21757, 21759, 21764,
    21780, 21782, 21809, 21811, 21822, 21824, 21836, 21839, 21843,
    21859, 21886, 21888, 21934, 21936, 21942, 21959, 21972, 21978,
    21980, 21983, 22007, 22009, 22022, 22025, 22036, 22043, 22057,
    22063, 22068, 22070, 22072, 22082, 22092, 22094, 22096, 22107,
    22116, 22120, 22132, 22136, 22138, 22144, 22154, 22159, 22164,
    22176, 22178, 22181, 22190, 22196, 22198, 22204, 22216, 22222,
    22225, 22227, 22238, 22240, 22243, 22254, 22256, 22269, 22283,
    22285, 22287, 22294, 22296, 22300, 22303, 22317, 22320, 22331,
    22336, 22338, 22343, 22346, 22361, 22369, 22399, 22402, 22411,
    22419, 22432, 22442, 22444, 22448, 22451, 22464, 22467, 22475,
    22478, 22486, 22492, 22499, 22516, 22519, 22524, 22528, 22530,
    22549, 22553, 22557, 22561, 22564, 22570, 22586, 22589, 22612,
    22622, 22626, 22633, 22635, 22640, 22642, 22645, 22649, 22654,
    22659, 22661, 22675, 22679, 22684, 22696, 22699, 22702, 22718,
    22721, 22725, 22727, 22730, 22732, 22737, 22739, 22741, 22748,
    22775, 22786, 22818, 22821, 22823, 22846, 22852, 22877, 22880,
    22885, 22892, 22894, 22904, 22909, 22922, 22925, 22931, 22934,
    22937, 22939, 22941, 22952, 22956, 22962, 22974, 22982, 22985,
    22987, 23004, 23016, 23030, 23035, 23039, 23041, 23043, 23049,
    23057, 23064, 23066, 23068, 23077, 23081, 23087, 23100, 23110,
    23113, 23130, 23138, 23142, 23146, 23148, 23167, 23186, 23241,
    23248, 23265, 23267, 23270, 23273, 23305, 23318, 23330, 23338,
    23340, 23344, 23346, 23350, 23358, 23360, 23363, 23365, 23391,
    23401, 23403, 23411, 23413, 23416, 23418, 23424, 23427, 23429,
    23439, 23445, 23455, 23470, 23472, 23497, 23500, 23504, 23512,
    23515, 23534, 23536, 23539, 23544, 23546, 23569, 23571, 23574,
    23578, 23582, 23584, 23586, 23588, 23592, 23597, 23601, 23624,
    23635, 23637, 23646, 23660, 23665, 23670, 23673, 23692, 23700,
    23713, 23718, 23729, 23731, 23742, 23749, 23751, 23769, 23789,
    23805, 23815, 23819, 23822, 23825, 23839, 23842, 23847, 23849,
    23874, 23886, 23888, 23900, 23913, 23919, 23923, 23926, 23938,
    23940, 23943, 23952, 23965, 23970, 23980, 23982, 24009, 24016,
    24022, 24027, 24033, 24035, 24043, 24046, 24055, 24059, 24070,
    24081, 24086, 24093, 24101, 24107, 24109, 24115, 24125, 24128,
    24135, 24140, 24142, 24151, 24159, 24193, 24199, 24202, 24207,
    24218, 24220, 24224, 24235, 24237, 24275, 24278, 24285, 24300,
    24321, 24347, 24351, 24353, 24361, 24365, 24367, 24369, 24380,
    24382, 24385, 24389, 24392, 24394, 24396, 24398, 24401, 24403,
    24409, 24435, 24439, 24441, 24444, 24478, 24503, 24505, 24515,
    24517, 24544, 24548, 24555, 24565, 24568, 24571, 24573, 24575,
    24594, 24601, 24623, 24625, 24634, 24646, 24653, 24656, 24658,
    24661, 24669, 24693, 24695, 24705, 24722, 24724, 24739, 24760,
    24785, 24787, 24789, 24792, 24794, 24796, 24803, 24835, 24838,
    24849, 24853, 24876, 24880, 24884, 24887, 24898, 24900, 24915,
    24917, 24925, 24927, 24933, 24939, 24958, 24962, 24967, 24970,
    24974, 24980, 24982, 24996, 24999, 25001, 25006, 25010, 25014,
    25018, 25022, 25027, 25040, 25059, 25062, 25074, 25076, 25082,
    25110, 25121, 25126, 25130, 25144, 25147, 25163, 25171, 25173,
    25176, 25179, 25182, 25184, 25187, 25192, 25198, 25201, 25206,
    25209, 25212, 25246, 25254, 25265, 25269, 25273, 25282, 25329,
    25331, 25356, 25361, 25369, 25375, 25387, 25391, 25402, 25417,
    25429, 25431, 25436, 25451, 25454, 25458, 25472, 25475, 25484,
    25490, 25494, 25496, 25499, 25509, 25522, 25531, 25534, 25536,
    25542, 25545, 25554, 25558, 25569, 25571, 25577, 25582, 25594,
    25606, 25613, 25615, 25619, 25628, 25638, 25640, 25652, 25654,
    25658, 25662, 25666, 25678, 25688, 25696, 25703, 25705, 25711,
    25718, 25720, 25722, 25731, 25736, 25749, 25754, 25769, 25771,
    25776, 25778, 25785, 25797, 25799, 25810, 25812, 25816, 25818,
    25836, 25839, 25844, 25846, 25850, 25856, 25861, 25880, 25903,
    25915, 25925, 25928, 25937, 25958, 25964, 25968, 25970, 25996,
    25998, 26007, 26009, 26015, 26017, 26023, 26039, 26041, 26049,
    26063, 26066, 26071, 26073, 26075, 26097, 26112, 26124, 26140,
    26161, 26175, 26185, 26187, 26191, 26194, 26199, 26201, 26210,
    26230, 26234, 26241, 26254, 26257, 26269, 26272, 26274, 26278,
    26283, 26286, 26290, 26292, 26300, 26305, 26308, 26311, 26313,
    26326, 26336, 26342, 26345, 26352, 26371, 26379, 26395, 26417,
    26420, 26426, 26429, 26431, 26433, 26438, 26441, 26451, 26454,
    26457, 26460, 26474, 26477, 26485, 26487, 26492, 26501, 26503,
    26505, 26512, 26517, 26519, 26522, 26534, 26537, 26543, 26555,
    26564, 26566, 26570, 26584, 26586, 26594, 26596, 26599, 26601,
    26604, 26609, 26619, 26643, 26654, 26674, 26676, 26694, 26696,
    26713, 26719, 26723, 26727, 26740, 26753, 26755, 26757, 26765,
    26767, 26775, 26779, 26781, 26786, 26797, 26803, 26812, 26820,
    26822, 26829, 26831, 26834, 26842, 26851, 26855, 26866, 26888,
    26898, 26920, 26922, 26928, 26932, 26934, 26937, 26941, 26943,
    26954, 26984, 27018, 27022, 27025, 27032, 27040, 27047, 27054,
    27060, 27067, 27073, 27075, 27079, 27088, 27091, 27106, 27115,
    27117, 27122, 27129, 27131, 27133, 27135, 27138, 27141, 27159,
    27161, 27163, 27182, 27184, 27197, 27204, 27211, 27231, 27238,
    27243, 27256, 27268, 27280, 27287, 27292, 27296, 27306, 27308,
    27310, 27315, 27320, 27323, 27345, 27347, 27362, 27364, 27368,
    27370, 27402, 27410, 27414, 27421, 27427, 27431, 27442, 27459,
    27463, 27465, 27468, 27470, 27472, 27481, 27483, 27487, 27494,
    27503, 27515, 27526, 27533, 27544, 27550, 27556, 27567, 27575,
    27595, 27606, 27608, 27611, 27615, 27631, 27635, 27656, 27663,
    27665, 27671, 27675, 27700, 27726, 27728, 27733, 27735, 27738,
    27746, 27752, 27754, 27770, 27782, 27784, 27792, 27798, 27819,
    27822, 27825, 27827, 27841, 27852, 27859, 27861, 27863, 27869,
    27877, 27880, 27882, 27891, 27908, 27922, 27927, 27929, 27931,
    27941, 27960, 27963, 27969, 27996, 28006, 28012, 28020, 28037,
    28044, 28046, 28051, 28057, 28076, 28079, 28082, 28085, 28088,
    28092, 28096, 28111, 28117, 28126, 28129, 28132, 28134, 28136,
    28142, 28149, 28165, 28179, 28181, 28189, 28201, 28220, 28222,
    28227, 28234, 28246, 28248, 28255, 28263, 28267, 28274, 28278,
    28290, 28300, 28310, 28312, 28319, 28322, 28325, 28330, 28335,
    28338, 28346, 28349, 28351, 28354, 28361, 28369, 28396, 28399,
    28402, 28404, 28422, 28425, 28431, 28433, 28448, 28472, 28481,
    28485, 28500, 28504, 28511, 28516, 28518, 28532, 28536, 28538,
    28540, 28548, 28550, 28552, 28558, 28561, 28567, 28577, 28586,
    28593, 28595, 28597, 28601, 28614, 28632, 28635, 28644, 28657,
    28659, 28666, 28670, 28673, 28677, 28679, 28681, 28683, 28687,
    28689, 28693, 28696, 28716, 28720, 28722, 28734, 28748, 28753,
    28760, 28771, 28779, 28792, 28805, 28814, 28818, 28825, 28851,
    28872, 28875, 28879, 28889, 28893, 28895, 28913, 28921, 28925,
    28932, 28937, 28943, 28948, 28956, 28961, 28966, 28982, 28988,
    29001, 29004, 29006, 29017, 29020, 29026, 29033, 29036, 29038,
    29053, 29060, 29064, 29066, 29071, 29081, 29087, 29096, 29100,
    29105, 29113, 29118, 29121, 29123, 29134, 29136, 29138, 29143,
    29173, 29177, 29190, 29197, 29200, 29211, 29224, 29226, 29232,
    29234, 29266, 29275, 29277, 29279, 29287, 29289, 29298, 29300,
    29305, 29319, 29330, 29334, 29344, 29346, 29351, 29356, 29359,
    29366, 29369, 29374, 29382, 29390, 29392, 29394, 29399, 29401,
    29403, 29417, 29450, 29471, 29492, 29527, 29539, 29544, 29546,
    29552, 29554, 29557, 29572, 29575, 29577, 29579, 29590, 29609,
    29627, 29629, 29632, 29634, 29650, 29654, 29662, 29664, 29667,
    29669, 29674, 29681, 29685, 29688, 29694, 29699, 29705, 29730,
    29742, 29754, 29759, 29761, 29781, 29811, 29814, 29822, 29827,
    29833, 29835, 29858, 29863, 29872, 29885, 29898, 29903, 29908,
    29916, 29920, 29929, 29934, 29953, 29969, 29971, 29973, 29976,
    29978, 29980, 29987, 29992, 30020, 30022, 30031, 30033, 30036,
    30048, 30050, 30061, 30079, 30082, 30097, 30100, 30106, 30109,
    30115, 30117, 30123, 30133, 30149, 30151, 30154, 30157, 30162,
    30171, 30174, 30185, 30192, 30202, 30204, 30209, 30217, 30219,
    30221, 30244, 30247, 30256, 30260, 30267, 30274, 30284, 30290,
    30294, 30296, 30300, 30316, 30320, 30322, 30326, 30328, 30336,
    30347, 30350, 30352, 30355, 30358, 30366, 30374, 30382, 30384,
    30388, 30399, 30406, 30408, 30410, 30413, 30418, 30433, 30439,
    30442, 30446, 30450, 30452, 30456, 30459, 30462, 30465, 30468,
    30491, 30505, 30522, 30524, 30528, 30561, 30563, 30568, 30571,
    30585, 30603, 30606, 30609, 30622, 30624, 30629, 30640, 30643,
    30646, 30649, 30655, 30663, 30669, 30679, 30693, 30695, 30697,
    30707, 30716, 30722, 30732, 30738, 30770, 30772, 30778, 30783,
    30789, 30798, 30813, 30820, 30831, 30834, 30836, 30842, 30844,
    30849, 30865, 30867, 30869, 30871, 30874, 30883, 30887, 30895,
    30901, 30906, 30908, 30910, 30913, 30932, 30938, 30956, 30959,
    30964, 30973, 30977, 30983, 30990, 31001, 31014, 31024, 31034,
    31036, 31038, 31056, 31059, 31066, 31074, 31077, 31080, 31085,
    31095, 31098, 31114, 31124, 31131, 31133, 31146, 31150, 31152,
    31155, 31177, 31179, 31189, 31192, 31199, 31201, 31209, 31212,
    31216, 31227, 31232, 31240, 31243, 31252, 31260, 31278, 31287,
    31302, 31305, 31319, 31337, 31339, 31344, 31348, 31350, 31357,
    31359, 31361, 31368, 31391, 31414, 31418, 31423, 31437, 31439,
    31445, 31469, 31478, 31487, 31490, 31492, 31494, 31496, 31503,
    31505, 31515, 31518, 31520, 31528, 31532, 31539, 31545, 31572,
    31574, 31581, 31589, 31591, 31596, 31598, 31610, 31627, 31629,
    31631, 31634, 31649, 31658, 31661, 31665, 31668, 31672, 31684,
    31689, 31695, 31709, 31712, 31721, 31725, 31731, 31744, 31751,
    31757, 31767, 31775, 31777, 31779, 31783, 31811, 31828, 31830,
    31832, 31852, 31859, 31861, 31870, 31881, 31883, 31885, 31888,
    31890, 31893, 31899, 31903, 31915, 31929, 31936, 31938, 31941,
    31946, 31950, 31954, 31958, 31960, 31964, 31970, 31975, 31983,
    31986, 31988, 31990, 31992, 31998, 32000, 32002, 32013, 32016,
    32053, 32063, 32072, 32086, 32094, 32102, 32104, 32110, 32121,
    32125, 32137, 32143, 32147, 32199, 32207, 32216, 32218, 32228,
    32236, 32239, 32242, 32244, 32251, 32257, 32274, 32283, 32294,
    32299, 32302, 32309, 32311, 32321, 32323, 32326, 32333, 32338,
    32365, 32368, 32377, 32383, 32396, 32406, 32566, 32568, 32570,
    32581, 32583, 32600, 32622, 32624, 32626, 32629, 32650, 32652,
    32654, 32660, 32666, 32673, 32690, 32694, 32701, 32705, 32714,
    32716, 32722, 32742, 32745, 32747, 32752, 32755, 32761, 32784,
    32786, 32789, 32796, 32801, 32808, 32819, 32822, 32827, 32829,
    32831, 32838, 32842, 32850, 32854, 32856, 32858, 32872, 32889,
    32905, 32915, 32918, 32920, 32925, 32933, 32943, 32948, 32954,
    32966, 32972, 32974, 32982, 32993, 33007, 33009, 33012, 33016,
    33026, 33059, 33065, 33071, 33073, 33075, 33081, 33086, 33094,
    33099, 33102, 33119, 33131, 33134, 33140, 33160, 33162, 33167,
    33171, 33173, 33178, 33184, 33200, 33203, 33205, 33208, 33210,
    33218, 33222, 33229, 33233, 33235, 33251, 33253, 33258, 33261,
    33278, 33285, 33296, 33298, 33326, 33331, 33344, 33351, 33373,
    33375, 33378, 33380, 33382, 33384, 33406, 33419, 33421, 33426,
    33433, 33437, 33439, 33455, 33457, 33459, 33467, 33469, 33477,
    33495, 33497, 33505, 33507, 33515, 33521, 33545, 33550, 33564,
    33571, 33576, 33579, 33583, 33600, 33605, 33618, 33624, 33634,
    33651, 33653, 33655, 33663, 33669, 33671, 33678, 33683, 33686,
    33690, 33698, 33704, 33713, 33717, 33725, 33729, 33733, 33735,
    33738, 33740, 33742, 33747, 33750, 33752, 33756, 33769, 33771,
    33780, 33787, 33789, 33799, 33811, 33824, 33826, 33836, 33841,
    33845, 33848, 33862, 33870, 33879, 33883, 33894, 33897, 33905,
    33909, 33911, 33922, 33924, 33931, 33936, 33940, 33945, 33948,
    33951, 33953, 33965, 33970, 33972, 33983, 33985, 33988, 33990,
    33997, 34006, 34012, 34028, 34030, 34036, 34044, 34054, 34065,
    34074, 34079, 34081, 34086, 34101, 34109, 34115, 34126, 34131,
    34133, 34147, 34157, 34167, 34174, 34176, 34180, 34186, 34196,
    34199, 34201, 34212, 34214, 34241, 34249, 34253, 34261, 34295,
    34302, 34306, 34330, 34338, 34349, 34367, 34384, 34394, 34396,
    34407, 34411, 34417, 34425, 34427, 34451, 34453, 34486, 34500,
    34505, 34507, 34516, 34521, 34523, 34532, 34537, 34555, 34558,
    34560, 34566, 34573, 34584, 34586, 34588, 34597, 34601, 34612,
    34615, 34619, 34623, 34633, 34638, 34643, 34645, 34647, 34649,
    34659, 34662, 34664, 34666, 34670, 34676, 34678, 34680, 34687,
    34690, 34701, 34719, 34722, 34731, 34735, 34739, 34749, 34752,
    34756, 34763, 34768, 34770, 34784, 34799, 34802, 34809, 34811,
    34814, 34821, 34823, 34833, 34855, 34865, 34870, 34873, 34875,
    34880, 34882, 34884, 34886, 34903, 34905, 34907, 34920, 34923,
    34928, 34930, 34933, 34935, 34952, 34955, 34957, 34962, 34969,
    34974, 34978, 34980, 34987, 34990, 34999, 35007, 35023, 35039,
    35041, 35048, 35074, 35076, 35079, 35082, 35084, 35088, 35109,
    35126, 35128, 35131, 35137, 35158, 35172, 35174, 35178, 35181,
    35183, 35186, 35188, 35191, 35201, 35203, 35215, 35219, 35226,
    35233, 35244, 35247, 35258, 35261, 35282, 35290, 35299, 35316,
    35320, 35328, 35336, 35338, 35340, 35342, 35344, 35355, 35357,
    35359, 35363, 35365, 35370, 35373, 35377, 35393, 35398, 35400,
    35419, 35422, 35424, 35430, 35433, 35449, 35452, 35458, 35463,
    35465, 35473, 35475, 35477, 35480, 35482, 35486, 35504, 35506,
    35513, 35516, 35522, 35524, 35527, 35535, 35538, 35542, 35556,
    35563, 35569, 35571, 35578, 35582, 35588, 35591, 35596, 35598,
    35600, 35604, 35613, 35622, 35624, 35635, 35641, 35646, 35649,
    35657, 35660, 35667, 35670, 35672, 35679, 35686, 35700, 35703,
    35709, 35715, 35722, 35724, 35726, 35728, 35734, 35895, 35898,
    35903, 35905, 35910, 35912, 35914, 35916, 35918, 35920, 35925,
    35930, 35964, 35970, 35973, 35988, 35992, 36042, 36049, 36051,
    36062, 36064, 36070, 36074, 36077, 36080, 36084, 36109, 36118,
    36196, 36203, 36205, 36225, 36229, 36234, 36249, 36259, 36264,
    36275, 36282, 36286, 36290, 36303, 36310, 36317, 36319, 36321,
    36323, 36328, 36335, 36339, 36341, 36348, 36351, 36394, 36400,
    36418, 36420, 36428, 36432, 36437, 36441, 36466, 36468, 36470,
    36476, 36481, 36487, 36493, 36497, 36505, 36513, 36542, 36552,
    36559, 36562, 36571, 36575, 36587, 36600, 36611, 36613, 36620,
    36633, 36639, 36646, 36655, 36659, 36667, 36674, 36681, 36695,
    36700, 36703, 36771, 36791, 36799, 36802, 36814, 36817, 36820,
    36826, 36834, 36845, 36852, 36861, 36867, 36875, 36903, 36910,
    36924, 36926, 36933, 36935, 36956, 36958, 36963, 36965, 36978,
    36986, 36999, 37007, 37009, 37027, 37030, 37032, 37034, 37039,
    37041, 37045, 37048, 37057, 37066, 37070, 37083, 37086, 37092,
    37096, 37101, 37109, 37111, 37117, 37122, 37138, 37141, 37145,
    37159, 37165, 37168, 37170, 37202, 37204, 37206, 37208, 37221,
    37228, 37237, 37250, 37255, 37257, 37259, 37261, 37264, 37266,
    37271, 37276, 37282, 37284, 37295, 37304, 37306, 37345, 37372,
    37375, 37382, 37386, 37406, 37417, 37420, 37428, 37431, 37436,
    37451, 37454, 37463, 37470, 37474, 37476, 37489, 37502, 37504,
    37507, 37509, 37512, 37521, 37523, 37528, 37543, 37549, 37559,
    37561, 37589, 37591, 37593, 37600, 37604, 37607, 37613, 37631,
    37634, 37638, 37672, 37682, 37685, 37700, 37704, 37707, 37709,
    37716, 37728, 37740, 37742, 37744, 37749, 37756, 37758, 37772,
    37780, 37786, 37796, 37799, 37808, 37817, 37827, 37830, 37832,
    37857, 37864, 37880, 37891, 37895, 37904, 37921, 37931, 37937,
    37944, 37946, 37953, 37960, 37982, 37984, 37986, 37994, 38000,
    38005, 38007, 38017, 38263, 38272, 38279, 38287, 38294, 38304,
    38317, 38322, 38329, 38334, 38339, 38343, 38346, 38360, 38364,
    38373, 38428, 38433, 38440, 38442, 38450, 38459, 38466, 38468,
    38506, 38508, 38512, 38522, 38525, 38536, 38560, 38563, 38570,
    38580, 38601, 38609, 38617, 38632, 38640, 38642, 38649, 38651,
    38656, 38660, 38666, 38673, 38675, 38678, 38681, 38684, 38686,
    38692, 38695, 38698, 38704, 38715, 38726, 38733, 38735, 38745,
    38748, 38750, 38756, 38758, 38763, 38765, 38769, 38772, 38780,
    38785, 38795, 38797, 38808, 38812, 38816, 38819, 38822, 38824,
    38827, 38829, 38851, 38854, 38856, 38859, 38867, 38876, 38907,
    38911, 38920, 38924, 38938, 38945, 38948, 38964, 38982, 39003,
    39006, 39013, 39015, 39019, 39080, 39082, 39087, 39089, 39094,
    39110, 39135, 39138, 39145, 39147, 39154, 39156, 39171, 39173,
    39180, 39184, 39192, 39204, 39212, 39214, 39234, 39237, 39241,
    39253, 39255, 39326, 39333, 39336, 39356, 39361, 39368, 39381,
    39384, 39387, 39389, 39391, 39394, 39416, 39419, 39423, 39425,
    39429, 39449, 39464, 39467, 39472, 39479, 39486, 39488, 39493,
    39509, 39511, 39519, 39522, 39592, 39597, 39600, 39608, 39612,
    39616, 39620, 39631, 39633, 39644, 39654, 39665, 39668, 39671,
    39675, 39686, 39704, 39706, 39711, 39717, 39761, 39764, 39768,
    39770, 39791, 39794, 39811, 39848, 39857, 39860, 39865, 39867,
    39872, 39878, 39887, 39892, 39894, 39899, 39912, 39925, 39936,
    39940, 39942, 39952, 39963, 39969, 39986, 39998, 40018, 40023,
    40026, 40032, 40039, 40054, 40056, 40165, 40167, 40169, 40176,
    40182, 40195, 40206, 40210, 40213, 40219, 40223, 40227, 40230,
    40232, 40251, 40257, 40260, 40262, 40264, 40281, 40292, 40306,
    40314, 40327, 40329, 40335, 40346, 40356, 40361, 40363, 40367,
    40370, 40372, 40376, 40388, 40390, 40399, 40403, 40409, 40422,
    40429, 40431, 40434, 40445, 40478, 40565, 40573, 40575, 40577,
    40584, 40597, 40599, 40605, 40607, 40621, 40644, 40660, 40672,
    40677, 40680, 40687, 40692, 40697, 40718, 40723, 40725, 40748,
    40763, 40766, 40786, 40788, 40810, 40812, 40818, 40845, 40853,
    40864, 64017, 64031, 64033 };
#define TOTAL_LEFTOVERS 2694
// }}}

/* Generates random SJIS/ASCII string */
char* rndstr_sjis (unsigned short len) {
    unsigned short n_len = (len + 2) * 4, c_len = 0;
    char* ret = malloc(n_len);

    for (unsigned short i = 0; i < len; ++i) {
        char* tmp;
        unsigned short sjis_or_ascii = RAND_RANGE(0, 10);

        if (sjis_or_ascii <= 7) {
            tmp = malloc(2);
            tmp[0] = RAND_ASCII;
            tmp[1] = '\0';
        } else {
            unsigned short c_range = RAND_RANGE(0, TOTAL_RANGES);
            if (c_range == TOTAL_RANGES)
                tmp = to_utf8(left_overs[RAND_RANGE(0, TOTAL_LEFTOVERS)]);
            else
                tmp = to_utf8(RAND_RANGE(ranges[c_range].min, ranges[c_range].max));
        }

        strcat(ret, tmp);
        c_len += strlen(tmp);
        free(tmp);
    }

    ret[c_len] = '\0';
    return ret;
}

